<?php
session_start();
include "dbconn.php";

$pid = $_GET['pid'];

// Assuming you want to update the user profile based on a form submission
if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    // Validate and sanitize user inputs
    // Update the database with the new profile information

    // Redirect to the profile page after updating
    header("Location: profile.php?pid=$pid");
    exit();
}

// Fetch user details for the specified $pid
$sql = "SELECT * FROM participant WHERE pid = $pid";
$result = mysqli_query($conn, $sql);
$row = mysqli_fetch_array($result);
?>

<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.2/font/bootstrap-icons.css">

    <title>CLUMS::Edit Profile</title>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <img class="mb-1" src="icon.png" alt="" width="45" height="45">
        <a class="navbar-brand" href="#">Unit Jaringan Komuniti</a>
        <div class="btn-group ml-auto">
            <button type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-person-circle"></i>
            </button>
            <div class="dropdown-menu dropdown-menu-right">
                <button class="dropdown-item" type="button">Register Program</button>
                <button class="dropdown-item" type="button">Update Status</button>
                <div class="dropdown-divider"></div>
                <button class="dropdown-item text-danger" type="button">Log out</button>
            </div>
        </div>
    </nav>

    <div class="mx-auto col-md-7">
        <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
            <h1 class="h2">Edit Profile</h1>
        </div>

        <div class="col-md-10">
            <div class="card text-black">
                <div class="card-body p-md-5 mx-md-4">
                    <!-- Change profile-->
                    <form method="post" action="editProfile.php?pid=<?php echo $pid; ?>">
                        <div class="form-group">
                            <label for="fullname">Fullname</label>
                            <input type="text" class="form-control" id="fullname" name="fullname" value="<?php echo $row['fullname']; ?>">
                        </div>
                        <div class="form-group">
                            <label for="nric">NRIC</label>
                            <input type="text" class="form-control" id="nric" name="nric" value="<?php echo $row['nric']; ?>">
                        </div>
                        <div class="form-group">
                            <label for="nric">Email Address</label>
                            <input type="email" class="form-control" id="email" name="email" value="<?php echo $row['email']; ?>">
                        </div>
                        <div class="form-group">
                            <label for="nric">Phone Number</label>
                            <input type="text" class="form-control" id="phone" name="phone" value="<?php echo $row['phone']; ?>">
                        </div>
                        <div class="form-group">
                            <label for="nric">Address</label>
                            <input type="text" class="form-control" id="address" name="address" value="<?php echo $row['address']; ?>">
                        </div>

                        <button type="submit" class="btn btn-primary">Update Profile</button>
                        <a href="profile.html?pid=<?php echo $pid; ?>" class="btn btn-primary bg-danger">Cancel</a>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js" integrity="sha384-+sLIOodYLS7CIrQpBjl+C7nPvqq+FbNUBDunl/OZv93DB7Ln/533i8e/mZXLi/P+" crossorigin="anonymous"></script>

</body>

</html>
